#+TITLE: Tennessee Eastman Process - Beginner Exercises
#+AUTHOR: TEP Python Package
#+OPTIONS: toc:t

* Introduction

These beginner exercises will help you get familiar with the Tennessee Eastman
Process (TEP) simulator and its basic functionality. Each exercise builds on
the previous one, introducing core concepts gradually.

* Exercise 1: First Simulation

** Objective
Run your first TEP simulation and understand the basic output structure.

** Tasks

1. Import the TEPSimulator class and create a simulator instance
2. Initialize the simulator
3. Run a short simulation (10 minutes = 600 seconds)
4. Examine the structure of the returned SimulationResult

** Starter Code

#+begin_src python
from tep import TEPSimulator

# Create simulator
sim = TEPSimulator()

# TODO: Initialize the simulator

# TODO: Run simulation for 10 minutes (use duration_hours=10/60)

# TODO: Print the shape of the measurements array
#+end_src

** Expected Output

You should see a measurements array with shape approximately (600, 41),
representing 600 time steps and 41 measured variables.

** Questions to Answer

1. What is the sampling interval of the simulation?
2. How many measured variables (XMEAS) are there?
3. What does the time array contain?

* Exercise 2: Exploring Process Variables

** Objective
Learn about the 41 measured variables and understand what they represent.

** Tasks

1. Use the constants module to access variable names
2. Plot a few key process variables over time
3. Identify which variables measure temperature, pressure, flow, etc.

** Starter Code

#+begin_src python
from tep import TEPSimulator
from tep.constants import XMEAS_NAMES
import matplotlib.pyplot as plt

# Run a simulation
sim = TEPSimulator()
sim.initialize()
result = sim.simulate(duration_hours=1.0)

# Print all variable names
for i, name in enumerate(XMEAS_NAMES):
    print(f"XMEAS({i+1}): {name}")

# TODO: Plot reactor pressure (XMEAS 7) over time

# TODO: Plot reactor temperature (XMEAS 9) over time

# TODO: Plot reactor level (XMEAS 8) over time
#+end_src

** Questions to Answer

1. Which variables measure compositions?
2. What are the units for pressure measurements?
3. Which variables show the most variation during normal operation?

* Exercise 3: Understanding Process Faults

** Objective
Learn about the 21 programmed faults and how to introduce them.

** Tasks

1. Review the list of available faults
2. Introduce a single fault during simulation
3. Compare normal vs. faulty operation visually

** Starter Code

#+begin_src python
from tep import TEPSimulator
from tep.constants import FAULT_DESCRIPTIONS
import matplotlib.pyplot as plt

# Print fault descriptions
for i, desc in enumerate(FAULT_DESCRIPTIONS[1:], 1):  # Skip normal operation
    print(f"IDV({i}): {desc}")

# Run normal operation
sim = TEPSimulator()
sim.initialize()
normal_result = sim.simulate(duration_hours=2.0)

# Run with IDV(1) - A/C feed ratio fault
sim.initialize()
fault_result = sim.simulate(
    duration_hours=2.0,
    disturbances={1: (0.5, 1)}  # Fault 1, starts at 0.5 hours, magnitude 1
)

# TODO: Plot reactor pressure for both normal and faulty operation
# TODO: Plot reactor level for both cases
# TODO: Identify when the fault effects become visible
#+end_src

** Questions to Answer

1. How long after fault introduction do you see effects?
2. Which measured variables are most affected by IDV(1)?
3. Does the process eventually stabilize or continue to deviate?

* Exercise 4: Manipulated Variables

** Objective
Understand the 12 manipulated variables (control inputs) and their effects.

** Tasks

1. List all manipulated variables
2. Observe the controller actions during normal operation
3. See how manipulated variables respond to faults

** Starter Code

#+begin_src python
from tep import TEPSimulator
from tep.constants import XMV_NAMES
import matplotlib.pyplot as plt

# Print manipulated variable names
for i, name in enumerate(XMV_NAMES):
    print(f"XMV({i+1}): {name}")

# Run simulation with fault
sim = TEPSimulator()
sim.initialize()
result = sim.simulate(
    duration_hours=2.0,
    disturbances={4: (0.5, 1)}  # IDV(4) - Cooling water temperature step
)

# TODO: Plot the cooling water flow (XMV 10) response

# TODO: Plot the reactor cooling water outlet temperature (XMEAS 21)

# TODO: Observe how the controller adjusts to maintain temperature
#+end_src

** Questions to Answer

1. How do controllers respond to disturbances?
2. Which manipulated variable controls reactor pressure?
3. Are there any manipulated variables that saturate (hit limits)?

* Exercise 5: Operating Modes

** Objective
Explore different operating modes of the TEP.

** Tasks

1. Learn about the 6 operating modes
2. Run simulations in different modes
3. Compare steady-state values across modes

** Starter Code

#+begin_src python
from tep import TEPSimulator

# Mode 1: Base case (G/H ratio = 50/50)
sim1 = TEPSimulator()
sim1.initialize(mode=1)
result1 = sim1.simulate(duration_hours=1.0)

# Mode 2: Different G/H ratio
sim2 = TEPSimulator()
sim2.initialize(mode=2)
result2 = sim2.simulate(duration_hours=1.0)

# TODO: Compare reactor conditions between modes
# - Reactor pressure
# - Reactor temperature
# - Production rates

# TODO: Print the final values for comparison
print("Mode 1 - Final reactor pressure:", result1.measurements[-1, 6])
print("Mode 2 - Final reactor pressure:", result2.measurements[-1, 6])
#+end_src

** Questions to Answer

1. What is the main difference between operating modes?
2. Which mode has higher reactor pressure?
3. Do all modes use the same control structure?

* Exercise 6: Basic Visualization

** Objective
Create informative plots of simulation data.

** Tasks

1. Create a multi-panel figure showing key variables
2. Add proper labels, titles, and legends
3. Save the figure to a file

** Starter Code

#+begin_src python
from tep import TEPSimulator
from tep.constants import XMEAS_NAMES
import matplotlib.pyplot as plt

# Run simulation with fault
sim = TEPSimulator()
sim.initialize()
result = sim.simulate(
    duration_hours=4.0,
    disturbances={6: (1.0, 1)}  # IDV(6) - A feed loss
)

# Create a 2x2 subplot figure
fig, axes = plt.subplots(2, 2, figsize=(12, 8))

# TODO: Plot reactor pressure in axes[0, 0]

# TODO: Plot reactor level in axes[0, 1]

# TODO: Plot A feed flow in axes[1, 0]

# TODO: Plot product flow in axes[1, 1]

# Add overall title
fig.suptitle('TEP Response to A Feed Loss (IDV 6)')

# Adjust layout and save
plt.tight_layout()
plt.savefig('idv6_response.png', dpi=150)
plt.show()
#+end_src

** Questions to Answer

1. What happens to A feed flow when IDV(6) occurs?
2. How does the reactor level respond?
3. Does the process recover or continue to degrade?

* Solutions

Solutions to these exercises are available in the =solutions/= directory.
Try to complete the exercises yourself before checking the solutions!
